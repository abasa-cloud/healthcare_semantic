version: 2 

metrics:
#=============#
# BASE METRIC #
#=============#
  - name: total_count_patient
    description: "Total count of patients"
    type: simple
    label: Total patient count
    type_params:
      measure:
        name: total_count_patient
        fill_nulls_with: 0 
        join_to_timespine: true

  - name: total_churn_patient
    description: "Total count of churn patients"
    type: simple
    label: Total churn patient count
    type_params:
      measure:
        name: total_churn_patient
        fill_nulls_with: 0 
        join_to_timespine: true

  - name: total_count_appt
    description: "Total count of all appointments. Historical reporting"
    type: simple
    label: Total appointment count
    type_params:
      measure:
        name: total_appt
        fill_nulls_with: 0
        join_to_timespine: true


#================#
# DERIVED METRIC #
#================#

#DERIVED METRIC TO CALCULATE CHURN RATE

  - name: churn_rate
    label: churn rate
    type: derived
    description: Metric to compute churn_rate.
    type_params:
      expr: (total_churn_patient/total_count_patient)*100
      metrics:
        - name: total_churn_patient
        - name: total_count_patient
